# Scraping Russia - Анализ рынка керамической плитки

## Описание проекта

**Scraping Russia** — это комплексная система для сбора, обработки и анализа данных о керамической плитке на российском рынке. Проект предназначен для оперативного мониторинга ситуации на рынке керамической плитки и определения конкурентного положения продукции компании **ОАО "КЕРАМИН"**.

### Ключевые возможности

- **Автоматический парсинг** данных с 4 крупнейших российских ритейлеров
- **Унификация данных** в единую структуру для удобного анализа
- **Гармонизация значений** полей (цвета, дизайны, бренды, типы поверхности)
- **Расчет аналитических метрик** (диапазоны цен, скидок, остатки)
- **Экспорт данных** в формате JSON для визуализации в Power BI и других BI-инструментах

---

## Источники данных

Проект собирает данные с 4 источников:

| № | Магазин | Наличие остатков | Особенности |
|---|---------|------------------|-------------|
| 1 | **LemanaPRO** (LeroyMerlin) | ✅ Да | Данные об онлайн-заказе |
| 2 | **OBI** | ✅ Да | Полные складские остатки |
| 3 | **Petrovich** | ✅ Да | Полные складские остатки |
| 4 | **Keramogranit_RU** | ❌ Нет | Только цены и характеристики |

---

## Структура проекта

```
Scraping_Russia/
│
├── LeroyMerlin/
│   ├── LemanaPRO.py              # Скрипт парсинга LemanaPRO
│   └── data_MM.YYYY_Tiles_LemanaPRO.json
│
├── Obi_selenium/
│   ├── Obi_selenium.py           # Скрипт парсинга OBI
│   └── data_MM.YYYY_plitka_plitka_i_keramogranit_Москва_obi.json
│
├── Petrovich/
│   ├── Petrovich.py              # Скрипт парсинга Petrovich
│   └── data_MM.YYYY_plitka_Petrovich.json
│
├── KeramogranitRU/
│   ├── KeramogranitRu.py         # Скрипт парсинга Keramogranit.ru
│   └── data_MM.YYYY_KeramogranitRu.json
│
├── MERGED_RUSSIA/
│   ├── Main_scraping_Russia.py   # Главный скрипт объединения данных
│   ├── harmonization.py          # Модуль гармонизации данных
│   └── data_finally.json         # Итоговый унифицированный файл
│
├── ChromeDriver/                 # ChromeDriver для Selenium
├── .gitignore
├── requirements.txt
└── README.md
```

---

## Установка и настройка

### Требования

- Python 3.8+
- Google Chrome (для Selenium)
- ChromeDriver (автоматически управляется через `undetected-chromedriver`)

### Установка зависимостей

```bash
# Клонировать репозиторий
git clone https://github.com/Eugene-Belitskiy/Scraping_Russia.git
cd Scraping_Russia

# Установить зависимости
pip install -r requirements.txt
```

---

## Использование

### 1. Запуск парсинга отдельных источников

Каждый источник имеет свой отдельный скрипт:

```bash
# LemanaPRO (LeroyMerlin)
python LeroyMerlin/LemanaPRO.py

# OBI
python Obi_selenium/Obi_selenium.py

# Petrovich
python Petrovich/Petrovich.py

# Keramogranit.ru
python KeramogranitRU/KeramogranitRu.py
```

Результаты сохраняются в формате JSON в соответствующих директориях.

### 2. Объединение и гармонизация данных

После сбора данных со всех источников, запустите главный скрипт:

```bash
python MERGED_RUSSIA/Main_scraping_Russia.py
```

Этот скрипт:
1. Загружает данные из всех источников
2. Фильтрует товары по материалу (Керамогранит, Керамика, Клинкер)
3. Нормализует форматы плитки
4. Рассчитывает диапазоны цен и скидок
5. Применяет гармонизацию данных
6. Добавляет основные поля для упрощения фильтрации
7. Удаляет дубликаты
8. Сохраняет результат в `MERGED_RUSSIA/data_finally.json`

---

## Модуль гармонизации данных (v2.2)

Модуль [`harmonization.py`](MERGED_RUSSIA/harmonization.py) приводит различные вариации значений полей к единому стандарту:

### Основные функции гармонизации

| Поле | Исходные варианты | Гармонизированные | Сокращение |
|------|-------------------|-------------------|------------|
| **Единицы измерения** | 12 вариантов | 4 варианта | -67% |
| **Дизайн** | 367 комбинаций | 311 комбинаций | Сохранены! |
| **Цвет** | 1,437 вариантов | 787 вариантов | -45% |
| **Тип поверхности** | 78 вариантов | 16 вариантов | -79% |
| **Бренды** | 384 бренда | 355 брендов | -8% |

### Новое в v2.2: Основные поля

Для упрощения фильтрации и визуализации добавлены поля:

- **"Основной дизайн"** — первый элемент из комбинации дизайнов
  - Было: 311 комбинаций → Стало: 68 основных дизайнов (-78%)
- **"Основной цвет"** — первый элемент из комбинации цветов
  - Было: 787 комбинаций → Стало: 662 основных цвета (-16%)

#### Примеры

```python
"Дизайн": "Мрамор, Камень"         → "Основной дизайн": "Мрамор"
"Цвет": "Белый, Серый"             → "Основной цвет": "Белый"
```

**Преимущества:**
- ✅ Быстрая фильтрация: `Основной дизайн == 'Мрамор'`
- ✅ Простые диаграммы и дашборды
- ✅ Полные комбинации СОХРАНЕНЫ для детального анализа

---

## Формат выходных данных

Итоговый файл `data_finally.json` содержит массив объектов со следующей структурой:

```json
{
  "Полное Наименование": "Керамогранит LB Ceramics...",
  "Действующая цена": 450.5,
  "Диапазон действующей цены": "400-500",
  "Размер скидки": 15,
  "Диапазон размера скидки": "10-20",
  "Единица измерения цены": "м²",
  "Ссылка": "https://...",
  "Магазин": "LemanaPRO",
  "Наличие": "Доступен в магазинах LemanaPRO",
  "Дата мониторинга": "2026-02-09",
  "Время мониторинга": "14:30:15",
  "Цвет": "Белый, Серый",
  "Основной цвет": "Белый",
  "Коллекция": "Marble",
  "Бренд": "LB",
  "Страна": "РОССИЯ",
  "Бренд-Страна": "LB (РОССИЯ)",
  "Толщина": 9.5,
  "Оригинальный формат": "60x60",
  "Формат": "60x60",
  "Дизайн": "Мрамор, Камень",
  "Основной дизайн": "Мрамор",
  "Материал": "Керамогранит",
  "Тип поверхности": "Матовая",
  "Тип покрытия (полир/лапп/неполир)": "Не полированный",
  "Структура": "Гладкая",
  "Количество лиц": "4",
  "Общий остаток": 50,
  "Упаковка": 1.44,
  "Общий остаток в единицах измерения": 72
}
```

---

## Технологии

- **Python 3.8+**
- **Selenium** + **undetected-chromedriver** — автоматизация браузера для динамических сайтов
- **BeautifulSoup4** — парсинг HTML
- **Requests** + **aiohttp** — HTTP-запросы (синхронные и асинхронные)
- **JSON** — формат хранения данных

---

## Применение

### Анализ рынка

Данные проекта используются для:

1. **Мониторинга цен конкурентов** — отслеживание динамики цен
2. **Анализа ассортимента** — популярные бренды, форматы, дизайны
3. **Оценки складских остатков** — доступность товаров на рынке
4. **Позиционирования продукции ОАО "КЕРАМИН"** — сравнение с конкурентами
5. **Визуализации в Power BI** — дашборды и отчеты

### Пример использования в Power BI

1. Импортировать `data_finally.json` в Power BI
2. Создать связи между таблицами
3. Построить дашборды:
   - Распределение цен по брендам
   - Топ-10 популярных форматов
   - Анализ скидок по магазинам
   - Карта доступности (остатки по магазинам)

---

## Особенности работы

### Обработка форматов плитки

- Округление до ближайшего кратного 5
- Сортировка размеров по убыванию (60x30, не 30x60)
- Словарь замен для нестандартных форматов

### Фильтрация материалов

Обрабатываются только 3 типа материалов:
- Керамогранит
- Керамика
- Клинкер

### Расчет диапазонов

- **Диапазон цен**: шаг 100 руб. (например, 400-500)
- **Диапазон скидок**: шаг 10% (например, 10-20)

---

## Примечания

- ⚠️ **Парсинг может занимать время** (в зависимости от количества товаров)
- ⚠️ **Некоторые сайты могут блокировать автоматические запросы** — используется `undetected-chromedriver` для обхода защиты
- ⚠️ **JSON файлы с данными не включены в репозиторий** (см. `.gitignore`)
- ⚠️ **ChromeDriver должен соответствовать версии Chrome** (автоматически управляется через `undetected-chromedriver`)

---

## Лицензия

[MIT License](LICENSE) — свободное использование для коммерческих и некоммерческих целей

---

## Автор

**Проект разработан для ОАО "КЕРАМИН"**
Для вопросов и предложений: [создайте Issue](https://github.com/YOUR_USERNAME/Scraping_Russia/issues)

---

## Благодарности

Проект создан с целью повышения эффективности анализа рынка керамической плитки и оперативного реагирования на изменения конкурентной среды.
